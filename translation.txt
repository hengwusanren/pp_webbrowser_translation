4 安全要求
本章包含的部分安全功能要求以及附加的扩展功能组件来自于 Common Criteria for Information Technology Security Evaluation, Version 3.1, Revision 4。

4.1 规定
CC 将安全功能组件的操作定义为：{{assignment}}，{{selection}}，{{selection}}下的{{assignment}}，{{refinement}}。这篇文档使用以下规定字体用于标识 CC 定义的这些操作。
- {{assignment}}：斜体；
- PP 作者制定的{{refinement}}：粗体的“{{refinement}}”，在元素编号之后，带有粗体标识的附加文字和删除线标识的删除部分（如有需要）；
- {{selection}}：下划线；
- {{selection}}下的{{assignment}}：斜体+下划线；
- {{iteration}}：{{iteration}}号带有括号。
扩展的安全功能要求则使用 在对应的安全功能要求的名称后面加上“EXT”标签 的方法进行标识。

4.2 安全功能要求
本节列举 TOE 可能需要满足的安全功能要求。

4.2.1 类：用户数据保护（User Data Protection, FDP）

访问控制功能
FDP_ACF_EXT.1 扩展：本地存储和会话存储的区分
FDP_ACF_EXT.1 TOE 应基于域名、协议和端口对本地（永久）存储和会话（临时）存储进行区分：
- 会话存储只能被发起会话的标签页或 window 对象所访问；
- 本地存储只能被运行同一 web 应用的标签页或 window 对象所访问。
Application Note:
本地存储和会话存储的区分在 World Wide Web Consortium (W3C) 的提案推荐标准（PR） "Web Storage" 中有被描述。
在这一上下文中，域名是互联网上的权限管理控制的范围，子域名则表示为顶级域名加个前缀；协议是计算机内部或之间数据传输的数字规则系统，在 web 环境中典型的协议是 HTTP 和 HTTPS；端口是种“应用特定”构造，用于在主机的操作系统中充当通信端点，在 web 环境中80端口是 HTTP 通信的默认端口（也可以使用其他端口），在一个 web 地址中端口跟在域名或子域名的后面（如 http://www.cnn.com:80）。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了 TSF 如何区分本地存储和会话存储。
Guidance
评估者应检验操作指南以确保其阐明了文件系统中用于本地存储的位置和用于会话存储的位置。
Tests
评估者应进行以下测试：
- 测试1：评估者应获得或创建 Javascript 脚本用于向本地/会话存储中存入信息并从中获取；还应搭建一个 web 服务器，包含两个或多个网页，使用不同的协议或端口。评估者应将脚本合并进网页中。评估者应使用两个或多个浏览器窗口打开同一个网页。评估者应验证，一个窗口中访问会话存储的脚本无法访问另一个窗口的会话存储。
- 测试2：用相同的 web 服务器，评估者应使用两个或多个浏览器标签页打开同一个网页。评估者应验证，一个标签页中访问会话存储的脚本无法访问另一个标签页的会话存储。
- 测试3：用相同的 web 服务器，评估者应使用两个或多个浏览器窗口打开同一个网页。评估者应验证，一个窗口中访问本地存储的脚本能够访问另一个窗口的本地存储。
- 测试4：用相同的 web 服务器，评估者应使用两个或多个浏览器标签页打开同一个网页。评估者应验证，一个标签页中访问本地存储的脚本能够访问另一个标签页的本地存储。
- 测试5：用相同的 web 服务器，评估者应使用浏览器窗口和标签页打开不同的网页。评估者应验证，运行在一个窗口或标签页中的一个域名/协议/端口下的网页上下文的脚本无法访问另一个窗口或标签页中的另一个域名/协议/端口下的存储信息。

cookie 管理
FDP_COO_EXT.1 扩展：cookie 阻止
FDP_COO_EXT.1.1 TOE 应能够阻止网站存储第三方 cookie。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了 TSF 如何阻止第三方 cookie 以及何时会阻止（例如，显然的是当此阻止功能被打开时）。
Guidance
评估者应检验操作指南以确保其为阻止第三方 cookie 提供了配置选项说明。
Tests
评估者应进行以下测试：
- 测试1：评估者应清除所有 cookie 然后配置 TOE 以允许第三方 cookie 的存储。评估者应载入一个存储第三方 cookie 的网页。评估者应前往 cookie 存储的位置并验证 cookie 是否已存在。
- 测试2：评估者应清除所有 cookie 然后配置 TOE 以禁止第三方 cookie 的存储。评估者应载入一个试图存储第三方 cookie 的网页并验证 cookie 是否未被存储。

信息删除
FDP_DEL_EXT.1 扩展：浏览器数据的删除
FDP_DEL_EXT.1.1 TOE 应能够让用户选择删除 TOE 的 [{{selection}}：浏览器缓存、历史、密码、web 表单信息、cookie、扩展程序、插件]。
FDP_DEL_EXT.1.2 TOE 应能够在浏览器退出时删除 TOE 的 [{{selection}}：浏览器缓存、历史、密码、web 表单信息、cookie、扩展程序、插件]。
Application Note:
如果扩展程序或插件在上面{{selection}}中被选中，附录 C 里相应的基于 selection 的要求必须也被包含在 ST 的主体中。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了浏览器内容存储在哪里、什么内容可被删除。TSS 也应描述浏览器退出时浏览器内容的删除过程。
Guidance
评估者应检验操作指南以确保其阐明了用户如何删除存储的内容以及哪些类型的内容可被选择删除。操作指南也应阐明以确保浏览器内容可在浏览器退出时被删除。
Tests
评估者应对每种类型的存储内容进行以下测试：
- 测试1：评估者应建立一个与 web 服务器的 web 会话（该会话创建并存储了内容）。评估者应验证：浏览器支持的类型的内容已被存储于（操作指南所阐明的）指定位置。然后评估者通过浏览器将内容删除，并验证：被存储的内容已从（操作指南所阐明的）指定位置被删除。
- 测试2：评估者应验证浏览器内容在文件系统特定位置。评估者应调用 TOE，通过它将内容删除，然后将 TOE 退出。评估者应前往（操作指南所阐明的）内容所在指定位置，验证存储的内容是否已被删除。

沙盒
FDP_SBX_EXT.1 扩展：渲染进程的沙盒机制
FDP_SBX_EXT.1.1 TOE 应确保网页渲染发生于一个符合以下限定条件的进程中：
- 渲染进程无法直接访问 TOE 平台所处的文件系统；
- 渲染进程无法直接和非 TOE 的进程进行进程间通信；
- The rendering process has reduced privilege with respect to other TOE processes [selection: [assignment: methods by which the principle of least privilege is implement for rendering processes], in no other ways].
Application Note:
浏览器实现了多种方法以确保渲染 HTML 并解释执行 Javascript 的进程运行在一个受限的环境中，以降低该渲染进程被其处理的 HTML 或 Javascript 搞崩溃的风险。这个组件要求 TSF 确保渲染进程无法直接访问主机的文件系统而且无法参与主机提供的进程间通信机制（即不能与主机上非 TOE 的进程进行通信），以此降低渲染进程的权限。典型地，如果一个渲染进程需要访问一个文件或与一个非 TOE 进程通信，它必须通过 TSF 请求这样的访问（这是被这一安全要求所允许的）。
除了要求的两种措施，其他措施可以依赖 TOE 和主机平台进行实现。可能包含这些做法：将渲染进程的所有者换成一个低权限用户，或减弱渲染进程的平台定义级别（platform-defined）的权限。ST 作者填写 TOE 实现的这些额外措施。
Assurance Acitivity:
TSS
评估者应检验 TSS 以确保其阐明了 TOE 在进程的角度上（进程是执行代码的有效实体）如何渲染 HTML 和解释执行 Javascript。对于渲染 HTML 和执行 Javascript 的进程，评估者应检验 TSS 以确保其阐明了这些进程是如何被阻止访问所在平台文件系统的。评估者应检验 TSS 以确保其阐明了平台提供的各种 IPC （进程间通信）机制，并对每种机制阐明渲染进程是如何被禁止使用该机制与非 TOE 进程通信的。评估者还应确认 TSS 阐明了 IPC 和文件系统如何可访问（如果 TOE 实现了这种可访问），例如可通过一个不负责网页渲染的更高权限的 TOE 进程。评估者应确保 TSS 中的这些阐述涵盖（适用） ST 中声明的所有平台。
对于 ST 作者在本组件的第三 bullet 中所列的每个附加的机制，评估者应检验 TSS 以确保：
1) 该机制被阐明了；2) 对该机制的详细阐述足够体现其对（渲染进程所实现的）最低权限原则（the principle of least privilege）的作用；3) TSS 适当提供了相应的辅助信息（或对这类信息资料的指向），为提到的最低权限原则提供上下文理解。
Guidance
评估者应检验操作指南以确保其阐明了对渲染进程的限制机制。此外，如果这样的机制可配置（例如，用户可以选择“启用”哪些机制），评估者应检验操作指南以确保“启用”和“禁用”这些机制的方法有被提供，并且这些操作的对应结果也有被描述。
Tests
注意：以下测试需要开发者提供给评估者一个测试平台，包括（普通消费者用户的平台版本中所没有的）调试和测试工具。
评估者应对 ST 中声明的每个平台进行以下测试：
- 测试1：评估者应使用调试或测试工具，向一个渲染进程导入代码，试图直接访问当前平台的文件系统，然后直接执行代码。评估者应确认这段代码的执行没能访问 TOE 文件系统。
- 测试2：对于 TSS 中阐述的每种 IPC 机制，评估者应使用调试或测试工具，向一个渲染进程导入代码，试图直接与平台上另一个非 TOE 的进程通信，然后直接执行代码。评估者应确认这段代码的执行没能达成目的。
- 测试3：对于 ST 中提到的每个附加机制，评估者应设计一个测试来证明这一机制的实际作用如 TSS 中所述。如果这样的测试无法做到，评估者应在测试报告中解释为什么这个机制无法测试。
- 测试4：对于每个可配置或可启用/禁用的机制，评估者应进行测试以确认这一机制配置起来和操作指南所说的一致。

同源策略
FDP_SOP_EXT.1 扩展：同源策略
FDP_SOP_EXT.1.1 TOE 应确保从一个源获取的内容无法与从另一个源获取的内容交互（在正被获取的内容的源没有允许的情况下）。
FDP_SOP_EXT.1.2 TOE 不应允许对不同域名有同源策略例外。
Application Note:
同源策略的概念在 RFC 6454 的 "The Web Origin Concept" 中有相关描述。
源的定义是域名、协议、端口的组合。两个 URI 享有相同的域名、协议和端口，则被认为是同源。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了其对同源策略的实现以及解释了其对 RFC 6454 的遵守。如果 TSF 允许对不同标签页或窗口的子域名放宽同源策略，则 TSS 应阐明这样的例外是如何实现的。
Guidance
N/A
Tests
评估者应进行如下测试：
- 测试1：评估者应获得或创建可从指定地址获取内容的脚本，并搭建一个 web 服务器（包含两个或多个网页代表不同域名）。评估者应将脚本合并入网页中。评估者应将每个页面关联到一个不同的协议和/或端口。评估者应打开两个或多个浏览器窗口并在各个窗口中打开网站的不同页面。评估者应运行脚本并验证：在一个窗口中运行的脚本无法访问另一个窗口中获取的内容。
- 测试2：使用同样的 web 服务器，评估者应打开两个或多个浏览器标签页并在各个标签页中打开网站的不同页面。评估者应运行脚本并验证：在一个标签页中运行的脚本无法访问另一个标签页中获取的内容。
- 测试3：如果 TSF 支持对子域名放宽同源策略，评估者应为 web 服务器配置子域名，重复测试1和测试2。评估者应验证：脚本能够从另一个窗口/标签页（其 URI 位于另一个子域名）获取内容。

安全的数据传输
FDP_STR_EXT.1 扩展：cookie 数据的安全传输
FDP_STR_EXT.1.1 TOE 应确保那些在 set-cookie 头中包含 "secure" attribute 的 cookie 是通过 HTTPS 发送的。
Application Note:
set-cookie 头功能在 RFC 6265 "HTTP State Management Mechanism" 中有被阐述。
Assurance Activity:
TSS
评估者应检验 TSS 以验证其阐明了 TOE 依据 RFC 6265 支持在 set-cookie 头中包含 "secure" attribute 的 cookie 并通过 HTTPS 发送。
Guidance
N/A
Tests
评估者应进行如下测试：
- 测试1：评估者应将 TOE （通过 HTTPS）连到一个（实现了 HTTPS 的）“cookie 允许”（指该网站未被禁用 cookie）的测试网站，且该网站赋予了 TOE 一个 "secure" cookie。评估者应检验 TOE 的 cookie 缓存，确认包含那个 secure cookie。
- 测试2：评估者应再次连上那个 cookie 允许的网站，这次是通过不安全通道，确认没有 secure cookie 被发送。

用户跟踪信息
FDP_TRK_EXT.1 扩展：跟踪信息收集
FDP_TRK_EXT.1.1 TOE 应支持










