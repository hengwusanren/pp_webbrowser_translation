4 安全要求
本章包含的部分安全功能要求以及附加的扩展功能组件来自于 Common Criteria for Information Technology Security Evaluation, Version 3.1, Revision 4。

4.1 规定
CC 将安全功能组件的操作定义为：{{assignment}}，{{selection}}，{{selection}}下的{{assignment}}，{{refinement}}。这篇文档使用以下规定字体用于标识 CC 定义的这些操作。
- {{assignment}}：斜体；
- PP 作者制定的{{refinement}}：粗体的“{{refinement}}”，在元素编号之后，带有粗体标识的附加文字和删除线标识的删除部分（如有需要）；
- {{selection}}：下划线；
- {{selection}}下的{{assignment}}：斜体+下划线；
- {{iteration}}：{{iteration}}号带有括号。
扩展的安全功能要求则使用 在对应的安全功能要求的名称后面加上“EXT”标签 的方法进行标识。

4.2 安全功能要求
本节列举 TOE 可能需要满足的安全功能要求。

4.2.1 类：用户数据保护（User Data Protection, FDP）

访问控制功能
FDP_ACF_EXT.1 扩展：本地存储和会话存储的区分
FDP_ACF_EXT.1 TOE 应基于域名、协议和端口对本地（永久）存储和会话（临时）存储进行区分：
- 会话存储只能被发起会话的标签页或 window 对象所访问；
- 本地存储只能被运行同一 web 应用的标签页或 window 对象所访问。
Application Note:
本地存储和会话存储的区分在 World Wide Web Consortium (W3C) 的提案推荐标准（PR） "Web Storage" 中有被描述。
在这一上下文中，域名是互联网上的权限管理控制的范围，子域名则表示为顶级域名加个前缀；协议是计算机内部或之间数据传输的数字规则系统，在 web 环境中典型的协议是 HTTP 和 HTTPS；端口是种“应用特定”构造，用于在计算机的宿主操作系统中充当通信端点，在 web 环境中80端口是 HTTP 通信的默认端口（也可以使用其他端口），在一个 web 地址中端口跟在域名或子域名的后面（如 http://www.cnn.com:80）。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了 TSF 如何区分本地存储和会话存储。
Guidance
评估者应检验操作指南以确保其阐明了文件系统中用于本地存储的位置和用于会话存储的位置。
Tests
评估者应进行以下测试：
- 测试1：评估者应获得或创建 Javascript 脚本用于向本地/会话存储中存入信息并从中获取；还应搭建一个 web 服务器，包含两个或多个网页，使用不同的协议或端口。评估者应将脚本合并进网页中。评估者应使用两个或多个浏览器窗口打开同一个网页。评估者应验证，一个窗口中访问会话存储的脚本无法访问另一个窗口的会话存储。
- 测试2：用相同的 web 服务器，评估者应使用两个或多个浏览器标签页打开同一个网页。评估者应验证，一个标签页中访问会话存储的脚本无法访问另一个标签页的会话存储。
- 测试3：用相同的 web 服务器，评估者应使用两个或多个浏览器窗口打开同一个网页。评估者应验证，一个窗口中访问本地存储的脚本能够访问另一个窗口的本地存储。
- 测试4：用相同的 web 服务器，评估者应使用两个或多个浏览器标签页打开同一个网页。评估者应验证，一个标签页中访问本地存储的脚本能够访问另一个标签页的本地存储。
- 测试5：用相同的 web 服务器，评估者应使用浏览器窗口和标签页打开不同的网页。评估者应验证，运行在一个窗口或标签页中的一个域名/协议/端口下的网页上下文的脚本无法访问另一个窗口或标签页中的另一个域名/协议/端口下的存储信息。

cookie 管理
FDP_COO_EXT.1 扩展：cookie 阻止
FDP_COO_EXT.1.1 TOE 应能够阻止网站存储第三方 cookie。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了 TSF 如何阻止第三方 cookie 以及何时会阻止（例如，显然的是当此阻止功能被打开时）。
Guidance
评估者应检验操作指南以确保其为阻止第三方 cookie 提供了配置选项说明。
Tests
评估者应进行以下测试：
- 测试1：评估者应清除所有 cookie 然后配置 TOE 以允许第三方 cookie 的存储。评估者应载入一个存储第三方 cookie 的网页。评估者应前往 cookie 存储的位置并验证 cookie 是否已存在。
- 测试2：评估者应清除所有 cookie 然后配置 TOE 以禁止第三方 cookie 的存储。评估者应载入一个试图存储第三方 cookie 的网页并验证 cookie 是否未被存储。

信息删除
FDP_DEL_EXT.1 扩展：浏览器数据的删除
FDP_DEL_EXT.1.1 TOE 应能够让用户选择删除 TOE 的 [{{selection}}：浏览器缓存、历史、密码、web 表单信息、cookie、扩展程序、插件]。
FDP_DEL_EXT.1.2 TOE 应能够在浏览器退出时删除 TOE 的 [{{selection}}：浏览器缓存、历史、密码、web 表单信息、cookie、扩展程序、插件]。
Application Note:
如果扩展程序或插件在上面{{selection}}中被选中，附录 C 里相应的基于 selection 的要求必须也被包含在 ST 的主体中。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了浏览器内容存储在哪里、什么内容可被删除。TSS 也应描述浏览器退出时浏览器内容的删除过程。
Guidance
评估者应检验操作指南以确保其阐明了用户如何删除存储的内容以及哪些类型的内容可被选择删除。操作指南也应阐明以确保浏览器内容可在浏览器退出时被删除。
Tests
评估者应进行以下测试：
- 测试1：评估者应