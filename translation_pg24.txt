附录 B：可选要求
如本保护轮廓的介绍部分中所说，基本要求（即必须由 TOE 或其所处平台完成的）已在本保护轮廓主体内容中包含。此外，还有其他3类要求在附录 B、C、D 中阐明。
第一类（就在本附录中）的要求可以包含在 ST 中，但不必让 TOE 声明和本保护轮廓的一致性（？）。第二类（在附录 C 中）的要求是本保护轮廓主体内容中基于选择的要求：如果做出一些选择，则需要再包含附录中一些额外的要求。第三类（在附录 D 中）的要求不必和本保护轮廓相一致，但会被包含在本保护轮廓的未来版本的基本要求中。注意到，ST 作者有责任确保所有可能与附录 B、C 和/或 D 中的要求相关联、但没被列出的（如 FMT 类型的要求）的要求也被涵盖在 ST 中。
任何时候这些内容可能被包含进 ST，而 TOE 仍不失与本保护轮廓的一致性。

B.1 类：用户数据保护（User Data Protection, FDP）
隐私浏览会话
FDP_PBR_EXT.1 扩展：隐私浏览会话
FDP_PBR_EXT.1.1 TOE 应能支持隐私浏览会话。
Application Note:
隐私浏览是一种模式，允许用户浏览网页时不存储浏览历史、图片和 cookie 等数据。支持此功能的浏览器应包含此项要求。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了 TOE 如何支持隐私浏览。TSS 应指明隐私浏览模式下哪些数据不被存储到本地，并描述在和不在隐私浏览模式下 TOE 和网站的交互有怎样的不同。
Guidance
评估者应检验操作指南以确保其包含了允许或禁止隐私浏览的操作步骤。
Tests
评估者应进行以下测试：
- 测试1：评估者应清除浏览历史和 cookie 缓存，并开启隐私浏览。评估者应打开测试的和/或真实的网站，确认浏览历史和 cookie 缓存保持不变。
- 测试2：评估者应禁止隐私浏览并再次访问同样的网站。评估者应检查确认浏览历史和 cookie 缓存已经发生更新，并反映了评估者的浏览活动。

附录 C：基于选择的要求
如本保护轮廓的介绍部分中所说，基本要求（即必须由 TOE 或其所处平台完成的）已在本保护轮廓主体内容中包含。本保护轮廓主体内容中有一些额外的基于选择的要求：如果做出一些选择，则需要再包含以下额外的要求。

C.1 类：加密支持（Cryptographic Support, FCS）
数据传输层安全（Datagram Transport Layer Security, DTLS）
FCS_DTLS_EXT.1 扩展：数据传输层安全
FCS_DTLS_EXT.1.1(2) [{{selection}}：TOE，TOE 平台] 应根据 DTLS 1.2 (RFC 6347) 实现 DTLS 协议。
FCS_DTLS_EXT.1.2(2) [{{selection}}：TOE，TOE 平台] 为了实现 DTLS，应实现 FCS_TLS_EXT.1 中的要求，除非根据 RFC 6347 允许有变化的情况。
Application Note:
DTLS 和 TLS 的区别在 RFC 6347 中有所概述，其他方面这两个协议是一样的。特别地，对于定义的适用于 TOE 的安全特性，两个协议没有差别。因此，所有为 FCS_TLSC_EXT.1 列举的 application notes 和 Assurance Activity 都适用于 DTLS 的实现。
Assurance Activity:
TSS
N/A
Guidance
N/A
Tests
评估者应试图建立与 DTLS 服务器的连接，用包分析器监听通信量（traffic），并验证：连接成功、通信量被识别为 DTLS。其他所有测试结合 FCS_TLSC_EXT.1 中列举的 Assurance Activity 进行。

C.2 类：用户数据保护（User Data Protection, FDP）
信息删除
FDP_DEL_EXT.2 扩展：扩展程序信息的删除
FDP_DEL_EXT.2.1 TOE 应能够删除扩展以此移除所有信息，包括扩展、配置项和存储的信息。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了扩展程序的存储位置、扩展程序被允许存储信息的位置。
Guidance
评估者应检验操作指南以确保其阐明了用户如何能删除扩展。
Tests
评估者应进行以下测试：
- 测试1：评估者应安装一个 TOE 扩展程序，然后检验 TOE 的文件系统，确认扩展及其数据如文档所说的那样被存储。评估者应再把这个 TOE 扩展卸载，然后检验 TOE 的文件系统，确认扩展及其数据从文档所说的位置被删除。

FDP_DEL_EXT.3 扩展：插件程序信息的删除
FDP_DEL_EXT.3.1 TOE 应能够删除插件以此移除所有信息，包括插件、配置项和存储的信息。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了插件程序的存储位置、插件程序被允许存储信息的位置、是否有选项可以删除所有插件信息。
Guidance
评估者应检验操作指南以确保其阐明了用户如何能删除插件及其关联内容。
Tests
评估者应进行以下测试：
- 测试1：评估者应安装一个 TOE 插件程序，然后检验 TOE 的文件系统，确认插件及其数据如文档所说的那样被存储。评估者应再把这个 TOE 插件卸载，然后检验 TOE 的文件系统，确认插件及其数据从文档所说的位置被删除。

C.3 类：TSF 保护（Protection of the TSF, FPT）
可信更新
FPT_TUD_EXT.2 扩展：可信的扩展程序更新
FPT_TUD_EXT.2.1 TOE 应能够查询扩展的当前版本。
FPT_TUD_EXT.2.2 TOE 应能够启动对扩展的更新。
FPT_TUD_EXT.2.3 TOE 应有办法在安装扩展或扩展更新之前，使用一个数字签名机制对其进行验证。
FPT_TUD_EXT.2.4 TOE 应能够阻止网站自动安装扩展。
Application Note:
扩展是打包的代码，添加进浏览器中实现浏览器默认不提供的特定功能。扩展可能是浏览器开发者或第三方开发的，被允许全部的访问权限对浏览器所见的 web 内容进行查看和交互。扩展普遍使用在非移动平台上，但在移动平台上可能不被支持，移动平台上提供富内容（rich content）的网站倾向于使用 HTML5。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了 TSF 能够确认扩展和扩展更新来自一个可信的源。评估者应检验 TSS 以确保其阐述了 TSF 会阻止来自未许可的源的扩展。
Guidance
评估者应检验操作指南以确保其阐明了如何给 TOE 配置可信的扩展源。
Tests
评估者应进行以下测试：
- 测试1：评估者应给 TOE 配置可信的源。评估者应创建或获得一个由可信源签名的扩展并安装它。评估者应确认扩展的签名有效。
- 测试2：评估者应创建或获得一个由不可信源签名的扩展并安装它。评估者应确认这个已签名的扩展被阻止。
- 测试3：评估者应创建或获得一个带有无效证书的签名的扩展并安装它。评估者应确认这个已签名的扩展被阻止。
- 测试4：评估者应创建或获得一个由可信源签名的扩展，修改它并且不对它二次签名，然后安装它。评估者应确认这个已签名的扩展被阻止。

FPT_TUD_EXT.3 扩展：可信的插件程序更新
FPT_TUD_EXT.3.1 TOE 应能够查询插件的当前版本。
FPT_TUD_EXT.3.2 TOE 应能够启动对插件和插件更新的下载。
FPT_TUD_EXT.3.3 TOE 应有办法在安装插件之前，使用一个数字签名机制和 [{{selection}}: published hash，无其他方法] 对其进行验证。
FPT_TUD_EXT.3.4 TOE 应能够阻止网站自动安装插件。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐述了 TSF 会阻止来自未许可的源的插件。
Guidance
评估者应检验操作指南以确保其阐明了如何给 TOE 配置可信的插件源。
Tests
评估者应进行以下测试：
- 测试1：评估者应给 TOE 配置可信的插件源。评估者应创建或获得一个由可信源签名的插件并安装它。评估者应确认插件的签名有效。
- 测试2：评估者应创建或获得一个由不可信源签名的插件并安装它。评估者应确认这个已签名的插件被阻止。
- 测试3：评估者应创建或获得一个带有无效证书的签名的插件并安装它。评估者应确认这个已签名的插件被阻止。
- 测试4：评估者应创建或获得一个由可信源签名的插件，修改它并且不对它二次签名，然后安装它。评估者应确认这个已签名的插件被阻止。

附录 D：客观要求
如本保护轮廓的介绍部分中所说，基本要求（即必须由 TOE 或其所处平台完成的）已在本保护轮廓主体内容中包含。有些额外的要求阐明了必要的安全功能，这些要求包含在本附录中。预计这些要求会在本保护轮廓的未来版本里从客观要求变成基本要求。

D.1 类：安全审计（Security Audit, FAU）
安全审计数据生成
FAU_GEN.1 审计数据生成
FAU_GEN.1.1 [{{selection}}：TOE，TOE 平台] 应能够生成一份以下可审计事件的审计记录：
- 审计功能的开启和关闭；
- 未指定审计级别（？）的所有可审计事件（All auditable events for the not specified level of audit）；
- 表格5列举的特别定义的可审计事件。
FAU_GEN.1.2 [{{selection}}：TOE，TOE 平台] 应在每个审计记录内至少记录以下信息：
a) 事件的日期和时间、事件类型、主体身份（？）、事件结果（成功或失败）。
Application Note:
ST 作者可以在表格里直接加入其他可审计事件，并不限于已列出的。
Assurance Acitivity:
TSS
N/A
Guidance
评估者应检验操作指南以确保其列举了所有可审计事件并提供了一个审计记录的格式。每个审计记录格式类型都必须被涵盖，包括每个字段的简要描述。评估者应确保： TSS 阐明了保护轮廓强制要求（？）的每个审计事件类型，字段的描述包含了 FAU_GEN.1.2 中要求的信息。
Tests
评估者应让 TOE 生成 FAU_GEN.1.1 中列举的事件的审计记录，以测试 TOE 能否正确生成审计记录。这应该包含一个事件的所有实例。评估者应测试，对于 ST 中包含的每一个加密协议，通道的建立和终止会生成审计记录。对于管理性行为（？），评估者应测试，前文中每个由评估者决定的安全相关的行为都是可审计的。当验证测试结果时，评估者应确保，测试过程中生成的审计记录与操作指南中指定的格式相匹配，每个审计记录中的字段有合适的词目，并且审计记录的提供方式适于解释。评估者还应确保能够基于事件类型、引发事件的责任用户、可用的证书，对审计数据进行搜索。
注意到，这里的测试可以直接结合安全机制的测试来进行。例如，为确保操作指南正确而进行的测试，验证了 AGD_OPE.1 要求得以满足，且应该说明用于验证审计记录成功生成的管理性行为的触发情况（？）。
表格5 可审计事件
……

安全审计事件选择
FAU_SEL.1 选择性审计
FAU_SEL.1.1 [{{selection}}：TOE，TOE 平台] 应能从所有可审计事件集合中选出一个要审计的事件集，基于以下属性：
a) 事件类型；
b) 可审计安全事件成功；
c) 可审计安全事件失败；和
d) [{{assignment}}：其他属性]。
Application Note:
本要求旨在列举出所有可被选择来触发审计事件的条件。这个可以由用户/管理员在客户端的界面上配置。对于 ST 作者，那个 {{assignment}} 是用来列举任何附加条件或者没有。可审计事件类型在表格5中被列出。
Assurance Activity:
TSS
N/A
Guidance
评估者应检验操作指南以确保其逐条列举了所有的事件类型，并描述了所有按照本要求要被选择的属性，包括那些列入 {{assignment}} 的属性。操作指南还应列举那些总被记录的审计记录，不管当前正被执行的选择条件。
Tests
测试应结合 FAU_GEN.1.1 的测试完成。

D.2 类：加密支持（Cryptographic Support, FCS）
强制安全传输（Strict Transport Security）
FCS_STS_EXT.1 扩展：强制安全传输
FCS_STS_EXT.1.1 [{{selection}}：TOE，TOE 平台] 应根据 RFC 6797 实现强制安全传输技术（HTTP Strict Transport Security, HSTS）。
FCS_STS_EXT.1.2 [{{selection}}：TOE，TOE 平台] 应保持持久数据信号传输允许 HSTS，持续时间为网站在 max-age 指令（a max-age directive，max-age 是指相对于接收到的时间开始可缓存多久，即最大寿命）中声明的时间长度。
FCS_STS_EXT.1.3 [{{selection}}：TOE，TOE 平台] 应缓存最新的 Strict Security 策略信息。
Application Note:
如果浏览器从网站接收 HSTS 头，TOE 和该网站所有域名或子域名之间的所有未来的 HTTP 一定都发生于 TLS 1.2 (RFC 5246) 或更高（？），使用 HTTPS (RFC 2818)。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了 TOE 如何支持 HSTS。
Guidance
评估者应检验操作指南以确保其包含了对如何使用 HSTS 的说明。
Tests
评估者应进行以下测试：
- 测试1：评估者应连上一个遵循 HSTS 的网站，同时运行一个网络协议分析器来监听通信。评估者应检查被抓捕的网络数据并确认收到一个 Strict Transport Security 的头并且有一个指令标记着 HSTS 关系的 max-age。
- 测试2：评估者应通过 HTTP 再次连接这个 HSTS 网站，应确认会话重定向到了 HTTPS。
- 测试3：评估者应在过了 max-age 的期限后再次连接这个 HSTS 网站，并确认网站和 TOE 重新建立了一个 HSTS 关系。
- 测试4：评估者应更新这个网站的 HSTS 信息，并确认当 TOE 再次连接到网站时，该信息已被 TOE 更新。

D.3 类：用户数据保护（User Data Protection, FDP）
访问控制策略
FDP_ACC_EXT.1 扩展：对域名的访问控制
FDP_ACC_EXT.1.1 TOE 应能够对域名分组，对特定的域名集合运用访问限制。
Application Note:
本功能的一个例子是 Internet Explorer 中 zones 的概念。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了 TSF 如何支持域名分组并对其运用访问限制。
Guidance
评估者应检验操作指南以确保其阐明了域名分组和访问限制的配置步骤。
Tests
评估者应进行以下测试：
- 评估者应创建一组域名并对其应用一个特定限制。评估者应导航到这个受限组里的域名的网站，确认限制生效。评估者应导航到不在这个受限组里的域名的网站，确认限制不起作用。

持久信息存储（Storage of Persistent Information）
FDP_PST_EXT.1 扩展：持久信息的存储
FDP_PST_EXT.1.1 TOE 应能在运行时不在文件系统中存储持久数据。
Application Note:
本要求不针对证书信息（credentials）、配置信息。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了 TOE 如何在运行时不把持久性用户数据保存在文件系统中。
Guidance
N/A
Tests
评估者应进行以下测试：
- 测试1：评估者应运行 TOE 一段时间，确保 TOE 的绝大部分功能被用遍。然后评估者应检验 TOE 及其所处平台，确保没有文件被写入文件系统，除了证书信息和配置信息。

D.4 类：TSF 保护（Protection of the TSF, FPT）
TOE 与外部实体的交互
FPT_INT_EXT.2 扩展：与应用程序评价服务的交互
FPT_INT_EXT.2.1 TOE 应使用一个应用程序评价服务以避免下载恶意程序。
Application Note:
应用程序评价服务是在线识别恶意程序的服务，用来在下载前检测出恶意程序。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了 TOE 使用应用程序评价服务检测恶意程序。
Guidance
评估者应检验操作指南以确保其阐明了 TOE 对应用程序评价服务的使用支持，包括哪些服务是 TOE 默认支持的（如果有的话）、附加的服务是否可配置。操作指南应包含应用程序评价服务的配置步骤。
Tests
评估者应进行以下测试：
- 测试1：评估者应按照操作指南配置 TOE 使之启用对一个或多个应用程序评价服务的使用。评估者应发起和一个网站的连接，在该网站上下载一个应用程序到 TOE，同时用一个网络协议分析器嗅探网络通信数据。评估者应检查被抓捕的网络数据并确认：TOE 在发起下载之前发起了和已配置的应用程序评价服务的连接。

FPT_INT_EXT.3 扩展：与 URL 评价服务的交互
FPT_INT_EXT.3.1 TOE 应使用一个 URL 评价服务以避免访问恶意网站。
Application Note:
URL 评价服务是在线识别带有恶意或钓鱼内容程序的网站的服务，用来在允许用户访问前检测出此类网站。
本要求的目的是确保 TOE 被阻止建立与已知的互联网上恶意程序来源的连接。在作出拦截决定之前采取的一系列行为细节可能取决于 TOE 的具体实现方式。例如，一些 TOE 实现恶意内容检查的方式可能是通过对照 URL 评价服务所提供的“不良” URL 列表进行实时检查；其他一些 TOE 可能是在 TOE 启动时就下载更新后的不良 URL 列表，定期从 URL 评价服务更新这个列表，直到 TOE 关闭。最终结果应是 TOE 阻止到不良 URL 的连接。
Assurance Activity:
TSS
评估者应检验 TSS 以确保其阐明了 TSF 使用 URL 评价服务检测恶意网站。
Guidance
评估者应检验操作指南以确保其阐明了 TOE 对 URL 评价服务的使用支持，包括哪些服务是 TOE 默认支持的（如果有的话）、附加的服务是否可配置。操作指南应包含 URL 评价服务的配置步骤。
Tests
评估者应进行以下测试：
- 测试1：评估者应按照操作指南配置 TOE 使之启用对一个或多个 URL 评价服务的使用。评估者应发起和一个已知的“良好”网站的连接，同时用一个网络协议分析器嗅探网络通信数据。评估者应检查被抓捕的网络数据并确认：TOE 发起了和已配置的 URL 评价服务的连接。
- 测试2：评估者应按照操作指南配置 TOE 使之启用对一个或多个 URL 评价服务的使用。评估者应发起和一个被 URL 评价服务识别为恶意的网站的连接，同时用一个网络协议分析器嗅探网络通信数据。评估者应确认，出现一个警告，提示网站是已知的恶意网站，且 TOE 不被允许连接该网站。评估者应检查被抓捕的网络数据并确认：TOE 发起了和已配置的 URL 评价服务的连接，并获取到一个更新了的恶意 URL 列表，被测网站名列其中。



