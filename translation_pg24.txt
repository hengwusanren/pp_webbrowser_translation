FCS_CKM_EXT.1 扩展：加密存储
FCS_CKM_EXT.1.1 [{{selection}}：TOE，TOE 平台] 应在平台提供的密钥存储库中存储持久隐私、私钥、[{{assignment}}：敏感的 web 表单数据] 和 "secure" cookies （当这些数据不在被使用时）。
Application Note:



FCS_CKM_EXT.4 扩展：密钥归零
FCS_CKM_EXT.4.1 [{{selection}}：TOE，TOE 平台] shall zeroize all plaintext secret and private cryptographic keys and CSPs when no longer required.
Application Note:



加密操作
FCS_COP.1(1) 加密操作（对于加密/解密）
FCS_COP.1.1(1) [{{selection}}：TOE，TOE 平台] shall perform [encryption/decryption] in accordance with a specified cryptographic algorithm
- AES-CBC (as defined in NIST SP 800-38A) mode;
[selection:
- AES-GCM (as defined in NIST SP 800-38D)
- no other modes]
and cryptographic key sizes 128-bit, 256-bit.
Application Note:



FCS_COP.1(2) 加密操作（对于哈希加密）
FCS_COP.1.1(2) [{{selection}}：TOE，TOE 平台] shall perform cryptographic hashing in
accordance with a specified cryptographic algorithm:
- SHA-1;
- SHA-256;
- SHA-384;
- [selection: SHA-512, no other algorithms]
and message digest sizes 160, 256, 384 and [selection: 512, no other sizes] that meet the
following: FIPS PUB 180-4.
Application Note:



FCS_COP.1(3) 加密操作（对于数字签名）
FCS_COP.1.1(3) [{{selection}}：TOE，TOE 平台] shall perform [cryptographic signature services in accordance with the following specified cryptographic algorithms
- RSA Digital Signature Algorithm (rDSA) with a key size (modulus) of 2048 bits or greater that meets FIPS PUB 180-2 or FIPS-PUB 186-4, "Digital Signature Standard",
- Elliptic Curve Digital Signature Algorithm (ECDSA) with a key size of 256 bits or greater that meets FIPS PUB 186-4, "Digital Signature Standard" with "NIST curves" P-256, P-384 and [selection: P-521, no other curves] (as defined in FIPS PUB 186-4, "Digital Signature Standard"),
[selection:
- Digital Signature Algorithm (DSA) with a key size (modulus) of 2048 bits or greater, that meets FIPS-PUB 186-4, "Digital Signature Standard";
- No other cryptographic signature service
].
Application Note:



FCS_COP.1(4) 加密操作（密钥相关的哈希运算消息认证（Keyed-Hash Message Authentication））
FCS_COP.1.1(4) [{{selection}}：TOE，TOE 平台] shall perform keyed-hash message
authentication in accordance with a specified cryptographic algorithm
- HMAC- SHA-256
[selection:
- SHA-1
- SHA-384
- SHA-512
- no other algorithms
],
key sizes [assignment: key size (in bits) used in HMAC], and message digest sizes 256 and [selection: 160, 384, 512, no other size] bits that meet the following: FIPS Pub 198-1, "The Keyed-Hash Message Authentication Code, and FIPS Pub 180-4, "Secure Hash Standard."
Application Note:



安全超文本传输协议（HTTPS）
FCS_HTTPS_EXT.1 扩展：HTTPS 实现
FCS_HTTPS_EXT.1.1 [{{selection}}：TOE，TOE 平台] shall implement the HTTPS protocol that complies with RFC 2818.
FCS_HTTPS_EXT.1.2 [{{selection}}：TOE，TOE 平台] shall implement HTTPS using TLS as specified in FCS_TLSC_EXT.1.


随机位生成
FCS_RBG_EXT.1 扩展：随机位生成
FCS_RBG_EXT.1.1 [{{selection}}：TOE，TOE 平台] shall perform all deterministic random bit generation services in accordance with [selection: choose one of: NIST Special Publication 800-90A using [selection: Hash_DRBG (any), HMAC_DRBG (any), CTR_DRBG (AES), Dual_EC_DRBG (any)]; FIPS Pub 140-2 Annex C: X9.31 Appendix 2.4 using AES].
FCS_RBG_EXT.1.2 The deterministic RBG shall be seeded by an entropy source that accumulates entropy from [selection: a software-based noise source, a platform-based RBG] with a minimum of [selection: 128 bits, 256 bits] of entropy at least equal to the greatest security strength (according to NIST SP 800-57) of the keys and hashes that it will generate.
Application Note:



传输层安全（TLS）
FCS_TLSC_EXT.1 扩展：传输层安全
FCS_TLSC_EXT.1.1 [{{selection}}：TOE，TOE 平台] shall implement TLS 1.2 (RFC 5246) supporting the following ciphersuites:
Mandatory Ciphersuites:
- TLS_RSA_WITH_AES_128_CBC_SHA，如 RFC 3268 中所定义
- TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256，如 RFC 5289 中所定义
- TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384，如 RFC 5289 中所定义
Optional Ciphersuites:
[selection:
- TLS_RSA_WITH_AES_256_CBC_SHA，如 RFC 3268 中所定义
- TLS_DHE_RSA_WITH_AES_128_CBC_SHA，如 RFC 3268 中所定义
- TLS_DHE_RSA_WITH_AES_256_CBC_SHA，如 RFC 3268 中所定义
- TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA，如 RFC 4492 中所定义
- TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA，如 RFC 4492 中所定义
- TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA，如 RFC 4492 中所定义
- TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA，如 RFC 4492 中所定义
- TLS_RSA_WITH_AES_128_CBC_SHA256，如 RFC 5246 中所定义
- TLS_RSA_WITH_AES_256_CBC_ SHA256，如 RFC 5246 中所定义
- TLS_DHE_RSA_WITH_AES_128_CBC_ SHA256，如 RFC 5246 中所定义
- TLS_DHE_RSA_WITH_AES_256_CBC_ SHA256，如 RFC 5246 中所定义
- TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256，如 RFC 5289 中所定义
- TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384，如 RFC 5289 中所定义
- no other ciphersuite
].
Application Note:

FCS_TLSC_EXT.1.2 The TOE shall not establish a trusted channel if the distinguished name (DN) contained in a certificate does not match the expected DN for the peer.
Application Note:

FCS_TLSC_EXT.1.3 The TOE shall present the signature_algorithm extension in the Client Hello with the following hash algorithms: [selection: SHA256, SHA384, SHA512] and no other hash algorithms.
Application Note:

FCS_TLSC_EXT.1.4 The TOE shall present the Supported Elliptic Curves Extension in the Client Hello with the following NIST curves: [selection: secp256r1, secp384r1, secp521r1] and no other curves.
Application Note:



4.3.2 类：识别与认证（Identification and Authentication, FIA）
X509 证书
FIA_X509_EXT.1 扩展：X509 验证（validation）
FIA_X509_EXT.1.1 [{{selection}}：TOE，TOE 平台] 应根据以下规则验证证书：
- RFC 5280 certificate validation and certificate path validation.
- The TSF shall validate a certificate path by ensuring the presence of the basicConstraints extension and that the cA flag is set to TRUE for all CA certificates.
- The TSF shall validate the revocation status of the certificate using [selection: the Online Certificate Status Protocol (OCSP) as specified in RFC 2560, a Certificate Revocation List (CRL) as specified in RFC 5759].
- The TSF shall validate the extendedKeyUsage field according to the following rules:
  - Certificates used for trusted updates and executable code integrity verification shall have the Code Signing purpose (id-kp 3 with OID 1.3.6.1.5.5.7.3.3).
  - Server certificates presented for TLS shall have the Server Authentication purpose (id-kp 1 with OID 1.3.6.1.5.5.7.3.1) in the extendedKeyUsage field.
Application Note:

FIA_X509_EXT.1.2 [{{selection}}：TOE，TOE 平台] shall only treat a certificate as a CA certificate if the basicConstraints extension is present and the CA flag is set to TRUE.
Application Note:



FIA_X509_EXT.2 扩展：X509 认证（authentication）
FIA_X509_EXT.2.1 [{{selection}}：TOE，TOE 平台] shall use X.509v3 certificates as defined by RFC 5280 to support authentication for HTTPS, TLS, and [selection: DTLS, no other protocol], and code signing for TOE updates, code signing for mobile code installation, and [selection: code signing for extension installation, code signing for plug-in installation, no additional uses].
Application Note:

FIA_X509_EXT.2.2 When [{{selection}}：TOE，TOE 平台] cannot establish a connection to determine the validity of a certificate, [{{selection}}：TOE，TOE 平台] shall [selection: allow the administrator to choose whether to accept the certificate in these cases, accept the certificate, not accept the certificate].
Application Note:

FIA_X509_EXT.2.3 [{{selection}}：TOE，TOE 平台] 应通知用户 if the peer certificate is deemed invalid during trusted communication channel establishment.
Application Note:

FIA_X509_EXT.2.4 如果代码签名证书被认为无效，[{{selection}}：TOE，TOE 平台] 不应安装运行代码。
Application Note:



4.3.3 类：安全管理（Security Management, FMT）
TSF 功能管理
FMT_MOF.1 Management of Functions Behavior
FMT_MOF.1.1 [{{selection}}：TOE，TOE 及其平台] shall restrict the ability to perform the functions:
1. enable/disable storage of sensitive web form information;
2. configuration of mobile code:
  a. ability to install mobile code;
  b. ability to uninstall mobile code;
  c. ability to update mobile code;
  d. ability to execute unsigned mobile code;
  e. ability to execute mobile code from an untrusted or unverified publisher
[selection:
3. enable/disable storage of third party cookies;
4. configuration of extensions:
  a. ability to install extensions;
  b. ability to uninstall extensions;
  c. ability to update extensions;
  d. ability to disable extensions
5. configuration of plug-ins:
  a. ability to install plug-ins;
  b. ability to uninstall plug-ins;
  c. ability to update plug-ins;
  d. ability to disable plug-ins
6. enable/disable use of OCSP for obtaining the revocation status of an X.509 certificate;
7. configure inclusion of user-agent information in HTTP headers;
8. enable/disable ability for websites to collect tracking information about the user
9. deletion of stored browsing data (cache, web form information):
  a. ability to specify which content should be deleted;
  b. ability to delete all stored content;
  c. automatically delete content upon termination of the browser session;
10. enable/disable storage of sensitive information in persistent storage;
11. ability to specify location where downloaded files are saved to disk;
12. configure size of cookie cache;
13. enable/disable interaction with Graphic Processing Units (GPUs)
14. configure the ability to advance to a web site with an invalid or unvalidated X.509 certificate;
15. enable/disable use of private browsing sessions;
16. configure the use of an application reputation service to detect malicious applications prior to downloading them;
17. configure the use of a URL reputation service to detect sites that contain malware or phishing content;
18. enable/disable automatic installation of software updates and patches;
19. enable/disable establishment of a trusted channel if the TSF cannot establish a connection to determine the validity of a certificate;
20. enable/disable ability for websites to register protocol handlers.
]
to an administrator according to the administrator policy.
Application Note:



管理功能规范
FMT_SMF.1 Specification of Management Functions
FMT_SMF.1.1 [{{selection}}：TOE，TOE 及其平台] 应能够执行以下管理功能：
1. enable/disable storage of sensitive web form information;
2. enable/disable storage of third party cookies;
3. configure inclusion of user-agent information in HTTP headers;
4. enable/disable ability for websites to collect tracking information about the user
5. deletion of browsing data (cache, web form information):
  a. ability to specify which content should be deleted;
  b. ability to delete all stored content;
  c. automatically delete content upon termination of the browser session;
6. configuration of mobile code:
  a. ability to install mobile code;
  b. ability to uninstall mobile code;
  c. ability to update mobile code;
  d. ability to execute unsigned mobile code;
  e. ability to execute mobile code from an untrusted or unverified publisher
7. ability to specify location where downloaded files are saved to disk;
8. configure size of cookie cache;
9. enable/disable the ability to advance to a web site with an invalid or unvalidated X.509 certificate;
10. enable/disable automatic installation of software updates and patches;
[selection:
11. configuration of extensions:
  a. ability to install extensions;
  b. ability to uninstall extensions;
  c. ability to update extensions;
  d. ability to disable extensions
12. configuration of plug-ins:
  e. ability to install plug-ins;
  f. ability to uninstall plug-ins;
  g. ability to update plug-ins;
  h. ability to disable plug-ins
13. enable/disable storage of sensitive information in persistent storage;
14. enable/disable use of OCSP for obtaining the revocation status of an X.509 certificate;
15. enable/disable interaction with Graphic Processing Units (GPUs)
16. enable/disable use of private browsing sessions;
17. configure the use of an application reputation service to detect malicious applications prior to downloading them;
18. configure the use of a URL reputation service to detect sites that contain malware or phishing content;
19. enable/disable establishment of a trusted channel if the TSF cannot establish a connection to determine the validity of a certificate;
20. enable/disable ability for websites to register protocol handlers
].
Application Note



FMT_SMR.1 安全管理角色
FMT_SMR.1.1 [{{selection}}：TOE，TOE 平台] shall maintain the roles: Administrator.
FMT_SMR.1.2 [{{selection}}：TOE，TOE 平台] shall be able to associate users with roles.


4.3.4 类：TSF 保护（Protection of the TSF, FPT）
TSF 自检（Self-Test）
FPT_TST_EXT.1 扩展：TSF 自检
FPT_TST_EXT.1.1 [{{selection}}：TOE，TOE 平台] shall run a suite of self-tests during initial start-up (on power on) to ensure the integrity of its executable and data.


可信更新
FPT_TUD_EXT.1 扩展：可信的软件更新和补丁
FPT_TUD_EXT.1.1 [{{selection}}：TOE，TOE 平台] shall provide the ability to query the current version of the TOE software, [selection: extension, plug-in, no other add-on].
FPT_TUD_EXT.1.2 [{{selection}}：TOE，TOE 平台] shall provide the ability to initiate updates and patches to the TOE software, [selection: extension, plug-in, no other add-on].
FPT_TUD_EXT.1.3 [{{selection}}：TOE，TOE 平台] shall provide a means to verify software updates and patches to the TOE, [selection: extension updates, plug-in updates, no other updates] using a digital signature mechanism and [selection: published hash, no other functions] prior to installing those updates and patches.
FTP_TUD_EXT.1.4 [{{selection}}：TOE，TOE 平台] shall provide the ability to install TOE updates and patches, [selection: extensions, plug-ins, no other add-on] automatically after verification.
Application Note:



4.3.5 类：可信路径/通道（Trusted Path/Channel, FTP）
可信通道
FTP_ITC.1 TSF 间的可信通道
FTP_ITC.1 Refinement: [{{selection}}：TOE，TOE 平台] shall use [selection: HTTPS, TLS, DTLS] to provide a trusted communication channel between itself and another trusted IT product that is logically distinct from other communication channels and provides assured identification of its end points and protection of the channel data from disclosure and detection of modification of the channel data.
FPT_ITC.1.2 [{{selection}}：TOE，TOE 平台] shall permit the TSF to initiate communication via the trusted channel.
FPT_ITC.1.3 [{{selection}}：TOE，TOE 平台] shall initiate communication via the trusted channel for all traffic traversing that connection.
Application Note:


